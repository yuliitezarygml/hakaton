* { box-sizing: border-box; margin: 0; padding: 0; }

body {
  width: 420px;
  min-height: 120px;
  max-height: 580px;
  background: #0d0d0d;
  color: #e5e5e5;
  font-family: 'Inter', system-ui, -apple-system, sans-serif;
  font-size: 13px;
  overflow-y: auto;
}

/* ── Header ── */
header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 14px 16px 12px;
  border-bottom: 1px solid #1e1e1e;
}
.title { font-size: 14px; font-weight: 600; color: #f0f0f0; }
.status-dot {
  width: 8px; height: 8px;
  border-radius: 50%;
  background: #3a3a3a;
  transition: background 0.3s;
}
.status-dot.online  { background: #22c55e; }
.status-dot.offline { background: #ef4444; }

/* ── Views ── */
.view { padding: 16px; }
.hidden { display: none !important; }

/* ── Buttons ── */
.btn-primary {
  width: 100%;
  padding: 10px;
  background: #0f2235;
  border: 1px solid #1a3a55;
  border-radius: 6px;
  color: #7dd3fc;
  font-size: 13px;
  cursor: pointer;
  transition: background 0.15s;
}
.btn-primary:hover:not(:disabled) { background: #152c45; }
.btn-primary:disabled { opacity: 0.45; cursor: not-allowed; }

.btn-secondary {
  padding: 7px 14px;
  background: #1a1a1a;
  border: 1px solid #2e2e2e;
  border-radius: 6px;
  color: #888;
  font-size: 12px;
  cursor: pointer;
  transition: background 0.15s;
  margin-top: 10px;
}
.btn-secondary:hover { background: #222; color: #aaa; }

.hint {
  margin-top: 14px;
  color: #444;
  font-size: 11px;
  text-align: center;
  line-height: 1.6;
}

/* ── Scan view ── */
.scan-header {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 10px;
}
.scan-pulse-dot {
  width: 8px; height: 8px;
  border-radius: 50%;
  background: #38bdf8;
  flex-shrink: 0;
  animation: scan-pulse 1s ease-in-out infinite;
}
@keyframes scan-pulse {
  0%, 100% { opacity: 1; transform: scale(1);    box-shadow: 0 0 0   0   rgba(56,189,248,0); }
  50%       { opacity: 0.7; transform: scale(1.2); box-shadow: 0 0 6px 3px rgba(56,189,248,0.4); }
}
.scan-title {
  font-size: 12px;
  font-weight: 600;
  color: #7dd3fc;
  flex: 1;
}
.scan-chars {
  font-size: 11px;
  font-family: 'Consolas', monospace;
  color: #4a9ab5;
}

.scan-progress-bar {
  height: 2px;
  background: #1a1a1a;
  border-radius: 2px;
  margin-bottom: 10px;
  overflow: hidden;
}
.scan-bar-fill {
  height: 100%;
  width: 0%;
  background: linear-gradient(90deg, #1d4ed8, #38bdf8);
  border-radius: 2px;
  transition: width 0.15s linear;
  box-shadow: 0 0 6px rgba(56,189,248,0.5);
}

#scan-feed {
  max-height: 330px;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 3px;
  margin-bottom: 4px;
  padding-right: 2px;
}
#scan-feed::-webkit-scrollbar { width: 3px; }
#scan-feed::-webkit-scrollbar-thumb { background: #2a2a2a; border-radius: 2px; }

.scan-chunk {
  display: flex;
  align-items: baseline;
  gap: 7px;
  padding: 4px 8px;
  border-radius: 4px;
  background: #0a0a0a;
  border: 1px solid #161616;
  font-family: 'JetBrains Mono', 'Consolas', monospace;
  font-size: 10.5px;
  opacity: 0;
  transform: translateY(6px);
  animation: chunk-in 0.18s ease forwards;
}
@keyframes chunk-in {
  to { opacity: 1; transform: translateY(0); }
}
.scan-tag {
  flex-shrink: 0;
  font-size: 9px;
  font-weight: 700;
  padding: 1px 5px;
  border-radius: 3px;
  letter-spacing: 0.03em;
}
.scan-tag-h1, .scan-tag-H1 { color: #7dd3fc; background: rgba(125,211,252,.08); border: 1px solid rgba(125,211,252,.2); }
.scan-tag-h2, .scan-tag-H2,
.scan-tag-h3, .scan-tag-H3,
.scan-tag-h4, .scan-tag-H4 { color: #93c5fd; background: rgba(147,197,253,.07); border: 1px solid rgba(147,197,253,.15); }
.scan-tag-p,  .scan-tag-§  { color: #4ade80; background: rgba(74,222,128,.07); border: 1px solid rgba(74,222,128,.15); }
.scan-tag-blockquote        { color: #a78bfa; background: rgba(167,139,250,.07); border: 1px solid rgba(167,139,250,.15); }
.scan-text {
  flex: 1;
  color: #666;
  line-height: 1.35;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* ── Event log ── */
#event-log {
  max-height: 400px;
  overflow-y: auto;
  background: #0a0a0a;
  border: 1px solid #1e1e1e;
  border-radius: 6px;
  display: flex;
  flex-direction: column;
}

.event-row {
  display: flex;
  align-items: flex-start;
  gap: 8px;
  padding: 6px 10px;
  border-bottom: 1px solid #141414;
  font-family: 'JetBrains Mono', 'Fira Code', 'Consolas', monospace;
  font-size: 11px;
}
.event-row:last-child { border-bottom: none; }

.event-badge {
  flex-shrink: 0;
  padding: 1px 6px;
  border-radius: 3px;
  font-size: 10px;
  font-weight: 500;
  text-transform: lowercase;
}

.badge-start    { color: #38bdf8; background: rgba(56,189,248,.08); border: 1px solid rgba(56,189,248,.18); }
.badge-progress { color: #34d399; background: rgba(52,211,153,.08); border: 1px solid rgba(52,211,153,.18); }
.badge-result   { color: #a78bfa; background: rgba(167,139,250,.08); border: 1px solid rgba(167,139,250,.18); }
.badge-done     { color: #fb923c; background: rgba(251,146,60,.08);  border: 1px solid rgba(251,146,60,.18); }
.badge-error    { color: #f87171; background: rgba(248,113,113,.08); border: 1px solid rgba(248,113,113,.18); }

.event-msg {
  flex: 1;
  color: #ccc;
  line-height: 1.4;
  word-break: break-word;
}

/* ── Result ── */
#result-header {
  display: flex;
  align-items: baseline;
  gap: 12px;
  margin-bottom: 14px;
  padding-bottom: 12px;
  border-bottom: 1px solid #1e1e1e;
}
#result-score {
  font-size: 30px;
  font-weight: bold;
  font-family: monospace;
  line-height: 1;
}
#result-verdict { font-size: 13px; font-weight: 600; }

#result-summary {
  color: #999;
  font-size: 12px;
  line-height: 1.6;
  margin-bottom: 14px;
}

.result-section { margin-bottom: 14px; }
.section-title  { font-size: 11px; font-weight: 600; margin-bottom: 6px; text-transform: uppercase; letter-spacing: .04em; }
.section-list   { list-style: none; display: flex; flex-direction: column; gap: 4px; }
.section-list li {
  font-size: 11.5px;
  color: #bbb;
  padding-left: 12px;
  position: relative;
  line-height: 1.5;
}
.section-list li::before { content: '•'; position: absolute; left: 0; color: #555; }

/* ── Chain button ── */
.btn-chain {
  width: 100%;
  margin-top: 8px;
  padding: 9px;
  background: #120d1f;
  border: 1px solid #2d1f4a;
  border-radius: 6px;
  color: #a78bfa;
  font-size: 13px;
  cursor: pointer;
  transition: background 0.15s;
}
.btn-chain:hover { background: #1a1030; }

/* ── Chain view ── */
.chain-header {
  display: flex; align-items: center; gap: 8px; margin-bottom: 8px;
}
.chain-title { font-size: 12px; font-weight: 600; color: #a78bfa; flex: 1; }
.btn-icon {
  background: none; border: none; color: #555; font-size: 13px;
  cursor: pointer; padding: 2px 6px; border-radius: 4px;
}
.btn-icon:hover { color: #aaa; background: #1a1a1a; }

.chain-status {
  font-size: 11px; color: #555; margin-bottom: 8px;
  font-family: 'Consolas', monospace; min-height: 16px;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}

#chain-nodes {
  display: flex; flex-direction: column; gap: 6px;
  max-height: 390px; overflow-y: auto; margin-bottom: 4px;
}
#chain-nodes::-webkit-scrollbar { width: 3px; }
#chain-nodes::-webkit-scrollbar-thumb { background: #2a2a2a; border-radius: 2px; }

.chain-node {
  background: #0a0a0a; border: 1px solid #1a1a1a; border-radius: 6px;
  padding: 8px 10px;
  opacity: 0; animation: chunk-in 0.2s ease forwards;
}
.chain-node.is-original { border-color: rgba(56,189,248,0.2); }

.chain-node-header {
  display: flex; align-items: center; gap: 6px; margin-bottom: 4px;
}
.chain-domain {
  font-size: 11px; font-weight: 600; color: #7dd3fc; flex: 1;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
.chain-badge-original {
  font-size: 9px; padding: 1px 6px; border-radius: 10px; flex-shrink: 0;
  background: rgba(56,189,248,.08); border: 1px solid rgba(56,189,248,.25);
  color: #38bdf8; font-weight: 600;
}
.chain-score {
  font-size: 10px; font-weight: 700; font-family: monospace;
  padding: 1px 6px; border-radius: 3px; flex-shrink: 0;
}
.chain-score.low  { color: #4ade80; background: rgba(74,222,128,.08);  border: 1px solid rgba(74,222,128,.2); }
.chain-score.med  { color: #facc15; background: rgba(250,204,21,.08);  border: 1px solid rgba(250,204,21,.2); }
.chain-score.high { color: #f87171; background: rgba(248,113,113,.08); border: 1px solid rgba(248,113,113,.2); }

.chain-node-title {
  font-size: 11px; color: #777; margin-bottom: 4px; line-height: 1.4;
  white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
.chain-node-summary {
  font-size: 10.5px; color: #555; margin-bottom: 5px; line-height: 1.4;
}
.chain-distortions { display: flex; flex-direction: column; gap: 3px; }
.chain-distortion {
  display: flex; gap: 5px; align-items: flex-start; font-size: 10px;
  line-height: 1.4;
}
.chain-dist-type {
  flex-shrink: 0; font-size: 9px; font-weight: 700; padding: 1px 4px;
  border-radius: 2px; letter-spacing: 0.03em; margin-top: 1px;
}
.chain-dist-type.exaggeration { color: #fb923c; background: rgba(251,146,60,.1);  border: 1px solid rgba(251,146,60,.25); }
.chain-dist-type.omission     { color: #a78bfa; background: rgba(167,139,250,.1); border: 1px solid rgba(167,139,250,.25); }
.chain-dist-type.addition     { color: #facc15; background: rgba(250,204,21,.1);  border: 1px solid rgba(250,204,21,.25); }
.chain-dist-type.change       { color: #f87171; background: rgba(248,113,113,.1); border: 1px solid rgba(248,113,113,.25); }
.chain-dist-text { color: #666; }
.chain-dist-orig { color: #888; text-decoration: line-through; }
.chain-dist-arrow { color: #444; margin: 0 2px; }
.chain-dist-new   { color: #d97706; }

/* ── Evidence section ── */
.evidence-body { display: flex; flex-direction: column; gap: 6px; }
.evidence-block {
  background: #060606;
  border: 1px solid #1a1a1a;
  border-radius: 4px;
  padding: 6px 9px;
}
.evidence-label {
  font-size: 9px;
  font-weight: 700;
  letter-spacing: 0.08em;
  text-transform: uppercase;
  color: #f97316;
  margin-bottom: 4px;
}
.evidence-text {
  font-size: 10.5px;
  color: #777;
  line-height: 1.55;
  white-space: pre-wrap;
  word-break: break-word;
}
.evidence-real {
  color: #555;
  border-left: 2px solid rgba(249,115,22,0.25);
  padding-left: 6px;
}
.evidence-reason {
  font-size: 10.5px;
  color: #f97316;
  line-height: 1.5;
  padding: 2px 0;
}

/* ── Sources section ── */
.source-list { display: flex; flex-direction: column; gap: 5px; }
.source-item {
  padding: 6px 8px;
  background: #060606;
  border: 1px solid #161616;
  border-radius: 4px;
  display: flex;
  flex-direction: column;
  gap: 3px;
}
.source-domain {
  align-self: flex-start;
  font-size: 9px;
  font-weight: 700;
  font-family: 'Consolas', monospace;
  color: #38bdf8;
  background: rgba(56,189,248,0.07);
  border: 1px solid rgba(56,189,248,0.18);
  padding: 1px 5px;
  border-radius: 2px;
  letter-spacing: 0.04em;
}
.source-link {
  color: #7dd3fc;
  font-size: 11px;
  text-decoration: none;
  line-height: 1.4;
  word-break: break-all;
}
.source-link:hover { color: #38bdf8; text-decoration: underline; }
.source-desc {
  font-size: 10px;
  color: #555;
  line-height: 1.45;
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
}
